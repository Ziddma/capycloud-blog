(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23],{424:()=>{},3576:()=>{},5356:e=>{"use strict";e.exports=require("node:buffer")},5521:e=>{"use strict";e.exports=require("node:async_hooks")},5609:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GET:()=>b,HEAD:()=>S,dynamic:()=>x,preferredRegion:()=>y,revalidate:()=>v,runtime:()=>w});let s=new Set(["prod-files-secure.s3.us-west-2.amazonaws.com","prod-files-secure.s3.amazonaws.com","s3.us-west-2.amazonaws.com","s3.amazonaws.com","www.notion.so","notion.so","www.notion-static.com","notion-static.com","images.unsplash.com"]),n=[".amazonaws.com",".notion-static.com",".notion.so",".s3.amazonaws.com"];function o(e){var t;let a,o=function(e){if(!e)return null;try{return decodeURIComponent(e)}catch{return e}}(e);if(!o||o.startsWith("/images/notion"))return null;try{a=new URL(o)}catch{return null}return/(http|https):/.test(a.protocol)&&(t=a.hostname)&&(s.has(t)||n.some(e=>t.endsWith(e)))?a:null}let r="public, max-age=0, s-maxage=43200, stale-while-revalidate=86400",i=new Set(["prod-files-secure.s3.us-west-2.amazonaws.com","prod-files-secure.s3.amazonaws.com","s3.us-west-2.amazonaws.com","s3.amazonaws.com","www.notion-static.com","notion-static.com"]),c=new TextEncoder,l={get:async()=>null,getWithMetadata:async()=>({value:null,metadata:null,cacheStatus:null}),async put(){},async delete(){},list:async()=>({keys:[],list_complete:!0,cacheStatus:null})},u=null,m=!1;function p(e){let t=function(e){if(!e||"object"!=typeof e)return null;if("env"in e&&e.env)return e.env;if("context"in e&&"object"==typeof e.context){let t=e.context;if(t?.env)return t.env}return null}(e);return t?.KV?t:(m||(console.warn("Missing Cloudflare KV binding in route context. Falling back to in-memory passthrough; images won't be cached locally."),m=!0),u||(u={KV:l}),u)}async function d(e){let t=c.encode(e),a=new Uint8Array(await crypto.subtle.digest("SHA-1",t)),s="";for(let e of a)s+=e.toString(16).padStart(2,"0");return s}function f(e,t,a){let s=new Headers,n=a??e?.headers.get("content-type")??"application/octet-stream";s.set("content-type",n);let o=e?.headers.get("cache-control");s.set("cache-control",o??r);let i=e?.headers.get("etag");i&&s.set("etag",i);let c=e?.headers.get("last-modified");return c&&s.set("last-modified",c),s.set("x-proxied-from",t.origin),s.set("access-control-allow-origin","*"),s}async function g(e,t,a,s,n){let c=globalThis.caches;if(c){let a=new Request(e.url,e),s=await c.default.match(a);if(s){let e=s.clone(),a=new Headers(e.headers);return(a.set("x-cache-status","edge-cache"),"HEAD"===t)?new Response(null,{status:e.status,statusText:e.statusText,headers:a}):new Response(e.body,{status:e.status,statusText:e.statusText,headers:a})}}let l=s??o(e.nextUrl.searchParams.get("src"));if(!l)return new Response("Missing or unsupported src parameter",{status:400});try{let s=[];i.has(l.hostname)&&s.push(function(e){let t=new URL(`https://www.notion.so/image/${encodeURIComponent(e.toString())}`);return t.searchParams.set("cache","v2"),t.searchParams.has("table")||t.searchParams.set("table","block"),t}(l)),s.push(l);let o=null,u={cf:{cacheTtl:43200,cacheEverything:!0}};for(let a of s){let s=new Request(a.toString(),{method:t,headers:{accept:e.headers.get("accept")??"image/*","user-agent":e.headers.get("user-agent")??"notion-image-proxy"}}),n=await fetch(s,u);if(n.ok){o=n;break}o&&403!==o.status&&404!==o.status?n.body?.cancel():o=n}if(!o||!o.ok){let e=o?.status??502;return o?.body?.cancel(),new Response("Upstream image request failed",{status:e})}let m=await o.arrayBuffer(),p=o.headers.get("content-type")??"application/octet-stream",g=f(o,l,p);g.set("cache-control",r),g.set("x-cache-status","origin");let h=n??await d(l.toString());try{await a.KV.put(h,m,{expirationTtl:2592e3,metadata:{contentType:p,source:l.toString()}})}catch(e){console.warn("Failed to persist image in KV",e)}let w=new Response("HEAD"===t?null:m,{status:200,headers:g});if(c&&"GET"===t)try{await c.default.put(new Request(e.url,e),w.clone())}catch(e){console.warn("Failed to cache image response",e)}return w}catch(e){return console.error("Image proxy error",e),new Response("Failed to proxy image",{status:502})}}async function h(e,t,a,s,n,o){try{let i=await s.KV.getWithMetadata(e,"arrayBuffer"),c=i.value,l=i.metadata;if(!c)return null;let u=f(null,a,l?.contentType);if(u.set("cache-control",r),u.set("x-cache-status","kv"),"HEAD"===t)return new Response(null,{status:200,headers:u});let m=new Response(c,{status:200,headers:u});if(n)try{await n.default.put(new Request(o.url,o),m.clone())}catch(e){console.warn("Failed to cache KV response",e)}return m}catch(e){return console.warn("Failed to read from KV",e),null}}let w="edge",y=["iad1","cdg1"],x="force-dynamic",v=0;async function b(e,t){let a=p(t),s=globalThis.caches,n=o(e.nextUrl.searchParams.get("src"));if(!n)return new Response("Missing or unsupported src parameter",{status:400});let r=await d(n.toString()),i=await h(r,"GET",n,a,s,e);return i||g(e,"GET",a,n,r)}async function S(e,t){let a=p(t),s=globalThis.caches,n=o(e.nextUrl.searchParams.get("src"));if(!n)return new Response("Missing or unsupported src parameter",{status:400});let r=await d(n.toString()),i=await h(r,"HEAD",n,a,s,e);return i||g(e,"HEAD",a,n,r)}},6091:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ComponentMod:()=>k,default:()=>P});var s,n={};a.r(n),a.d(n,{GET:()=>w,HEAD:()=>y,dynamic:()=>g,preferredRegion:()=>f,revalidate:()=>h,runtime:()=>d});var o={};a.r(o),a.d(o,{patchFetch:()=>R,routeModule:()=>x,serverHooks:()=>S,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>b});var r=a(8614),i=a(1373),c=a(9096),l=a(5096),u=a(621),m=a(68),p=a(5609);let d="edge",f=["iad1","cdg1"],g="force-dynamic",h=0;async function w(e,t){return(0,p.GET)(e,t)}async function y(e,t){return(0,p.HEAD)(e,t)}let x=new l.AppRouteRouteModule({definition:{kind:u.A.APP_ROUTE,page:"/images/notion-cover/route",pathname:"/images/notion-cover",filename:"route",bundlePath:"app/images/notion-cover/route"},resolvedPagePath:"/mnt/e/Documents/Study/capycloud/notion-blogs/src/app/images/notion-cover/route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:v,workUnitAsyncStorage:b,serverHooks:S}=x;function R(){return(0,m.V5)({workAsyncStorage:v,workUnitAsyncStorage:b})}let E=null==(s=self.__RSC_MANIFEST)?void 0:s["/images/notion-cover/route"],T=(e=>e?JSON.parse(e):void 0)(self.__RSC_SERVER_MANIFEST);E&&T&&(0,i.fQ)({page:"/images/notion-cover/route",clientReferenceManifest:E,serverActionsManifest:T,serverModuleMap:(0,r.e)({serverActionsManifest:T})});let k=o,P=c.s.wrap(x,{nextConfig:{env:{},webpack:null,eslint:{ignoreDuringBuilds:!1},typescript:{ignoreBuildErrors:!1,tsconfigPath:"tsconfig.json"},distDir:".next",cleanDistDir:!0,assetPrefix:"",cacheMaxMemorySize:0x3200000,configOrigin:"next.config.ts",useFileSystemPublicRoutes:!0,generateEtags:!0,pageExtensions:["tsx","ts","jsx","js"],poweredByHeader:!0,compress:!0,images:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",remotePatterns:[{protocol:"https",hostname:"prod-files-secure.s3.us-west-2.amazonaws.com"},{protocol:"https",hostname:"www.notion.so"},{protocol:"https",hostname:"images.unsplash.com"},{protocol:"https",hostname:"www.notion-static.com"}],unoptimized:!0},devIndicators:{position:"bottom-left"},onDemandEntries:{maxInactiveAge:6e4,pagesBufferLength:5},amp:{canonicalBase:""},basePath:"",sassOptions:{},trailingSlash:!1,i18n:null,productionBrowserSourceMaps:!1,excludeDefaultMomentLocales:!0,serverRuntimeConfig:{},publicRuntimeConfig:{},reactProductionProfiling:!1,reactStrictMode:null,reactMaxHeadersLength:6e3,httpAgentOptions:{keepAlive:!0},logging:{},expireTime:31536e3,staticPageGenerationTimeout:60,modularizeImports:{"@mui/icons-material":{transform:"@mui/icons-material/{{member}}"},lodash:{transform:"lodash/{{member}}"}},outputFileTracingRoot:"/mnt/e/Documents/Study/capycloud/notion-blogs",experimental:{nodeMiddleware:!1,cacheLife:{default:{stale:300,revalidate:900,expire:0xfffffffe},seconds:{stale:0,revalidate:1,expire:60},minutes:{stale:300,revalidate:60,expire:3600},hours:{stale:300,revalidate:3600,expire:86400},days:{stale:300,revalidate:86400,expire:604800},weeks:{stale:300,revalidate:604800,expire:2592e3},max:{stale:300,revalidate:2592e3,expire:0xfffffffe}},cacheHandlers:{},cssChunking:!0,multiZoneDraftMode:!1,appNavFailHandling:!1,prerenderEarlyExit:!0,serverMinification:!0,serverSourceMaps:!1,linkNoTouchStart:!1,caseSensitiveRoutes:!1,clientSegmentCache:!1,dynamicOnHover:!1,preloadEntriesOnStart:!0,clientRouterFilter:!0,clientRouterFilterRedirects:!1,fetchCacheKeyPrefix:"",middlewarePrefetch:"flexible",optimisticClientCache:!0,manualClientBasePath:!1,cpus:1,memoryBasedWorkersCount:!1,imgOptConcurrency:null,imgOptTimeoutInSeconds:7,imgOptMaxInputPixels:0xfff8001,imgOptSequentialRead:null,isrFlushToDisk:!0,workerThreads:!1,optimizeCss:!1,nextScriptWorkers:!1,scrollRestoration:!1,externalDir:!1,disableOptimizedLoading:!1,gzipSize:!0,craCompat:!1,esmExternals:!0,fullySpecified:!1,swcTraceProfiling:!1,forceSwcTransforms:!1,largePageDataBytes:128e3,typedRoutes:!1,typedEnv:!1,parallelServerCompiles:!1,parallelServerBuildTraces:!1,ppr:!1,authInterrupts:!1,webpackMemoryOptimizations:!1,optimizeServerReact:!0,useEarlyImport:!1,viewTransition:!1,routerBFCache:!1,staleTimes:{dynamic:0,static:300},serverComponentsHmrCache:!0,staticGenerationMaxConcurrency:8,staticGenerationMinPagesPerWorker:25,dynamicIO:!1,inlineCss:!1,useCache:!1,optimizePackageImports:["lucide-react","date-fns","lodash-es","ramda","antd","react-bootstrap","ahooks","@ant-design/icons","@headlessui/react","@headlessui-float/react","@heroicons/react/20/solid","@heroicons/react/24/solid","@heroicons/react/24/outline","@visx/visx","@tremor/react","rxjs","@mui/material","@mui/icons-material","recharts","react-use","effect","@effect/schema","@effect/platform","@effect/platform-node","@effect/platform-browser","@effect/platform-bun","@effect/sql","@effect/sql-mssql","@effect/sql-mysql2","@effect/sql-pg","@effect/sql-squlite-node","@effect/sql-squlite-bun","@effect/sql-squlite-wasm","@effect/sql-squlite-react-native","@effect/rpc","@effect/rpc-http","@effect/typeclass","@effect/experimental","@effect/opentelemetry","@material-ui/core","@material-ui/icons","@tabler/icons-react","mui-core","react-icons/ai","react-icons/bi","react-icons/bs","react-icons/cg","react-icons/ci","react-icons/di","react-icons/fa","react-icons/fa6","react-icons/fc","react-icons/fi","react-icons/gi","react-icons/go","react-icons/gr","react-icons/hi","react-icons/hi2","react-icons/im","react-icons/io","react-icons/io5","react-icons/lia","react-icons/lib","react-icons/lu","react-icons/md","react-icons/pi","react-icons/ri","react-icons/rx","react-icons/si","react-icons/sl","react-icons/tb","react-icons/tfi","react-icons/ti","react-icons/vsc","react-icons/wi"]},htmlLimitedBots:"Mediapartners-Google|Slurp|DuckDuckBot|baiduspider|yandex|sogou|bitlybot|tumblr|vkShare|quora link preview|redditbot|ia_archiver|Bingbot|BingPreview|applebot|facebookexternalhit|facebookcatalog|Twitterbot|LinkedInBot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|Yeti",bundlePagesRouterDependencies:!1,configFile:"/mnt/e/Documents/Study/capycloud/notion-blogs/next.config.ts",configFileName:"next.config.ts",outputFileTracingExcludes:{"*":["**/@img/sharp*/**","**/sharp/lib/**"]},generateStatic500:!1,turbopack:{root:"/mnt/e/Documents/Study/capycloud/notion-blogs"}}})}},e=>{var t=t=>e(e.s=t);e.O(0,[570],()=>t(6091));var a=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/images/notion-cover/route"]=a}]);
//# sourceMappingURL=route.js.map